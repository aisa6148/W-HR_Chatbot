{"version":3,"file":"chat-logger.js","sourceRoot":"","sources":["../../src/middleware/chat-logger.ts"],"names":[],"mappings":"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"}